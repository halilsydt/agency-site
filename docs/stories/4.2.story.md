# Story 4.2: Terms of Service Page

## Status

Done

## Story

**As a** visitor,
**I want** to read the terms of service,
**so that** I understand the terms of engaging with the agency.

## Acceptance Criteria

1. Terms of Service page accessible from footer
2. Content covers: service terms, disclaimers, liability limitations
3. Formatted for readability
4. Last updated date displayed
5. Placeholder content acceptable if legal review pending

## Tasks / Subtasks

- [x] Task 1: Create Terms of Service content JSON file (AC: 2, 3, 4)
  - [x] Create `content/legal/terms.json`
  - [x] Define `TermsOfServiceContent` type in `lib/types.ts` (reuses existing `LegalSection` interface)
  - [x] Structure content with sections array containing: title, content
  - [x] Include sections: Introduction, Services, Disclaimers, Liability Limitations, Intellectual Property, Termination, Governing Law, Contact
  - [x] Include `lastUpdated` date field

- [x] Task 2: Create content accessor function (AC: 2, 3, 4)
  - [x] Add `getTermsOfServiceContent()` function in `lib/content.ts`
  - [x] Import terms.json and cast to typed interface
  - [x] Add JSDoc documentation

- [x] Task 3: Create Terms of Service page (AC: 1, 3, 4)
  - [x] Create `app/terms/page.tsx`
  - [x] Add SEO metadata (title, description, openGraph)
  - [x] Create hero section with page title
  - [x] Render "Last Updated" date prominently
  - [x] Map through content sections rendering headings and paragraphs
  - [x] Use Container component for consistent layout
  - [x] Ensure proper heading hierarchy (h1 for title, h2 for sections)

- [x] Task 4: Verify footer link works (AC: 1)
  - [x] Confirm `/terms` route renders correctly
  - [x] Verify footer link at `/terms` navigates to page
  - [x] Link already exists in `components/layout/footer.tsx` lines 259-264

- [x] Task 5: Write component tests (AC: all)
  - [x] Create `tests/app/terms.test.tsx`
    - Test: renders page title
    - Test: renders last updated date
    - Test: renders all content sections
    - Test: has correct heading hierarchy
  - [x] Create `tests/lib/content-terms.test.ts`
    - Test: getTermsOfServiceContent returns valid data
    - Test: lastUpdated is present
    - Test: sections array has expected structure

- [x] Task 6: Final verification (AC: all)
  - [x] Run `npm run lint` - ensure no errors
  - [x] Run `npm run build` - ensure successful build
  - [x] Run `npm run test:run` - ensure all tests pass
  - [x] Manually verify page is accessible from footer link
  - [x] Manually verify content is readable and properly formatted

## Dev Notes

### Previous Story Insights (Story 4.1)
[Source: docs/stories/4.1.story.md#dev-agent-record]

- 355 tests passing with Vitest + React Testing Library
- Privacy Policy successfully implemented using same pattern needed for Terms
- Content accessor pattern: `getXContent()` returns typed content from JSON
- `LegalSection` interface already exists in `lib/types.ts` for reuse
- `PrivacyPolicyContent` interface serves as template for `TermsOfServiceContent`
- Footer link to `/terms` already exists at lines 259-264
- Lint and build passing

### Page File Location
[Source: docs/architecture/unified-project-structure.md]

```
app/
├── terms/
│   └── page.tsx            # Terms of Service (/terms)
```

The terms page route is already defined in the architecture. The footer link to `/terms` already exists in `components/layout/footer.tsx` lines 259-264.

### Content File Pattern
[Source: docs/architecture/unified-project-structure.md, lib/content.ts]

Following existing content patterns established in Story 4.1:
- JSON content files in `content/legal/` directory
- Type definitions in `lib/types.ts`
- Accessor functions in `lib/content.ts`

Create new structure:
```
content/
├── legal/
│   ├── privacy.json        # Already exists (Story 4.1)
│   └── terms.json          # NEW - Terms of Service content
```

### Terms of Service Content Structure
[Source: lib/types.ts, existing LegalSection interface]

The `LegalSection` interface already exists from Story 4.1. Add a new parallel interface:

```typescript
// lib/types.ts - Add new type (follows PrivacyPolicyContent pattern)
/**
 * Terms of Service page content structure.
 */
export interface TermsOfServiceContent {
  /** Page title */
  title: string;
  /** Last updated date (ISO format) */
  lastUpdated: string;
  /** Introduction text */
  introduction: string;
  /** Content sections */
  sections: LegalSection[];
}
```

### Terms of Service Content Sections
[Source: docs/prd/epic-details.md - Story 4.2 AC]

Based on AC requirements, terms.json should include sections for:

| Section ID | Title | Purpose |
|------------|-------|---------|
| services | Services | Description of services offered |
| disclaimers | Disclaimers | No guarantees, results may vary |
| liability | Limitation of Liability | Liability caps and exclusions |
| intellectual-property | Intellectual Property | Ownership of materials/content |
| termination | Termination | How services can be terminated |
| governing-law | Governing Law | Jurisdiction and legal framework |
| contact | Contact | How to reach us for questions |

### Page Component Pattern
[Source: app/privacy/page.tsx]

Follow the exact same pattern as the Privacy Policy page:
- Server component (no "use client" needed for static content)
- Export `metadata` for SEO
- Use `Container` for layout
- JSDoc for page component

The Privacy Policy page (`app/privacy/page.tsx`) is the template to follow exactly. Structure:

```typescript
import type { Metadata } from "next";
import { getTermsOfServiceContent } from "@/lib/content";
import { Container } from "@/components/layout/container";

export const metadata: Metadata = {
  title: "Terms of Service | Marketplace Consultants",
  description: "Read our terms of service and conditions for using our consulting services.",
  openGraph: {
    title: "Terms of Service | Marketplace Consultants",
    description: "Read our terms of service and conditions for using our consulting services.",
    type: "website",
  },
};

/**
 * Terms of Service page.
 * Displays the terms of service content with sections for service terms,
 * disclaimers, liability limitations, and other legal information.
 */
export default function TermsPage(): React.ReactElement {
  const content = getTermsOfServiceContent();

  return (
    <main>
      {/* Hero Section - matches privacy page */}
      {/* Content Section - matches privacy page */}
    </main>
  );
}
```

### Styling Considerations
[Source: app/privacy/page.tsx, tailwind.config.ts]

Use identical styling as Privacy Policy page:
- Hero: `py-12 md:py-16 bg-muted/30`
- Content: `py-16 md:py-20`
- Max width: `max-w-3xl mx-auto`
- Section spacing: `space-y-12`
- Heading: `text-2xl md:text-3xl font-semibold`
- Paragraphs: `text-base text-muted-foreground leading-relaxed`

### Heading Hierarchy for Accessibility
[Source: docs/architecture/coding-standards.md - Accessibility]

- `h1`: Page title ("Terms of Service")
- `h2`: Section headings (Services, Disclaimers, etc.)
- Avoid skipping heading levels
- Semantic HTML structure important for SEO

### Existing Footer Link
[Source: components/layout/footer.tsx lines 259-264]

The footer already contains the Terms of Service link:
```tsx
<Link
  href="/terms"
  className="transition-colors hover:text-primary"
>
  Terms of Service
</Link>
```

No modifications to footer needed.

## Testing

[Source: docs/architecture/testing-strategy.md]

### Test Locations
- `tests/app/terms.test.tsx` - Page component tests
- `tests/lib/content-terms.test.ts` - Content accessor tests

### Testing Framework
- Vitest + React Testing Library
- Import from `@testing-library/react`
- Use `describe`, `it`, `expect` from `vitest`

### Terms Page Test Examples
[Source: tests/app/privacy.test.tsx - use as template]

```typescript
// tests/app/terms.test.tsx
import { render, screen } from "@testing-library/react";
import { describe, it, expect } from "vitest";
import TermsPage from "@/app/terms/page";

describe("TermsPage", () => {
  it("renders page title", () => {
    render(<TermsPage />);
    expect(screen.getByRole("heading", { level: 1 })).toHaveTextContent(/terms of service/i);
  });

  it("renders last updated date", () => {
    render(<TermsPage />);
    expect(screen.getByText(/last updated/i)).toBeInTheDocument();
  });

  it("renders content sections with h2 headings", () => {
    render(<TermsPage />);
    const h2s = screen.getAllByRole("heading", { level: 2 });
    expect(h2s.length).toBeGreaterThan(0);
  });

  it("has correct heading hierarchy", () => {
    render(<TermsPage />);
    const h1 = screen.getByRole("heading", { level: 1 });
    const h2s = screen.getAllByRole("heading", { level: 2 });
    expect(h1).toBeInTheDocument();
    expect(h2s.length).toBeGreaterThan(0);
  });
});
```

### Content Accessor Test Examples
[Source: tests/lib/content-privacy.test.ts - use as template]

```typescript
// tests/lib/content-terms.test.ts
import { describe, it, expect } from "vitest";
import { getTermsOfServiceContent } from "@/lib/content";

describe("getTermsOfServiceContent", () => {
  it("returns valid terms of service content", () => {
    const content = getTermsOfServiceContent();
    expect(content).toBeDefined();
    expect(content.title).toBeTruthy();
    expect(content.lastUpdated).toBeTruthy();
  });

  it("has introduction text", () => {
    const content = getTermsOfServiceContent();
    expect(content.introduction).toBeTruthy();
  });

  it("has sections array with expected structure", () => {
    const content = getTermsOfServiceContent();
    expect(Array.isArray(content.sections)).toBe(true);
    expect(content.sections.length).toBeGreaterThan(0);

    content.sections.forEach((section) => {
      expect(section.id).toBeTruthy();
      expect(section.title).toBeTruthy();
      expect(Array.isArray(section.content)).toBe(true);
    });
  });
});
```

### Test Coverage Goals
- Page renders correctly with all content
- Content accessor returns properly typed data
- Heading hierarchy is correct (h1 → h2)
- Last updated date is displayed
- All sections are rendered

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-06 | 1.0 | Initial story draft | SM Agent (Bob) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References
None - implementation completed without issues

### Completion Notes List
- Created Terms of Service content JSON with 7 sections (Services, Disclaimers, Liability, IP, Termination, Governing Law, Contact)
- Added `TermsOfServiceContent` type in lib/types.ts (reuses existing `LegalSection` interface)
- Added `getTermsOfServiceContent()` accessor function with JSDoc documentation
- Created Terms page at app/terms/page.tsx following Privacy Policy pattern exactly
- Footer link already existed at lines 259-264, verified working
- All 365 tests pass (10 new tests added: 5 page tests + 5 content accessor tests)
- Lint passes with no errors
- Build succeeds with /terms route at 149B

### File List
| File | Action |
|------|--------|
| content/legal/terms.json | Created |
| lib/types.ts | Modified (added TermsOfServiceContent interface) |
| lib/content.ts | Modified (added import and getTermsOfServiceContent function) |
| app/terms/page.tsx | Created |
| tests/app/terms.test.tsx | Created |
| tests/lib/content-terms.test.ts | Created |

---

## QA Results

### Review Date: 2025-12-06

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Excellent implementation that follows established patterns precisely. The Terms of Service page mirrors the Privacy Policy implementation pattern, demonstrating good code reuse through the shared `LegalSection` interface. The content-driven architecture (JSON → typed accessor → component) is well-executed and maintainable.

Key strengths:
- Server component with static generation (optimal performance at 149B)
- Proper TypeScript types with comprehensive JSDoc documentation
- Clean component structure with semantic HTML and correct heading hierarchy
- Content easily updatable without code changes

### Refactoring Performed

None required - implementation is clean and follows best practices.

### Compliance Check

- Coding Standards: ✓ Proper JSDoc, TypeScript types, consistent formatting
- Project Structure: ✓ Files in correct locations per unified-project-structure.md
- Testing Strategy: ✓ 10 unit tests covering page and content accessor
- All ACs Met: ✓ All 5 acceptance criteria fully implemented and verified

### Improvements Checklist

All items passing - no changes required:

- [x] Content structure matches requirements (services, disclaimers, liability, etc.)
- [x] Proper heading hierarchy (h1 → h2) for accessibility
- [x] Last updated date displayed prominently
- [x] Footer link works correctly (verified at footer.tsx lines 259-264)
- [x] Tests cover all key functionality
- [x] Lint passes with no errors
- [x] Build succeeds (static page at 149B)
- [x] All 365 tests pass

### Security Review

No security concerns - static content page with no user input or dynamic data handling.

### Performance Considerations

Optimal performance achieved:
- Static page generation at build time
- Minimal bundle size (149B)
- No client-side JavaScript required

### Files Modified During Review

None - no modifications needed.

### Gate Status

Gate: PASS → docs/qa/gates/4.2-terms-of-service-page.yml

### Recommended Status

✓ Ready for Done

All acceptance criteria met. Implementation is clean, well-tested, and follows established patterns.
