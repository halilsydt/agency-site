# Story 3.1: Pricing Page

## Status

Done

## Story

**As a** visitor,
**I want** to see all pricing packages clearly displayed,
**so that** I can choose the right service level for my needs and budget.

## Acceptance Criteria

1. Page headline emphasizing transparent pricing
2. Amazon Packages section with 2-3 tiers (e.g., Starter, Growth, Premium)
3. Etsy Packages section with 2-3 tiers
4. Each package shows: name, price, included services, CTA
5. Bundle discount prominently highlighted (both platforms)
6. Visual hierarchy making popular/recommended option stand out
7. CTAs link to contact/booking
8. Responsive pricing cards
9. Placeholder prices if final pricing not confirmed

## Tasks / Subtasks

- [x] Task 1: Create pricing page route (AC: 8)
  - [x] Create directory `app/pricing/`
  - [x] Create `app/pricing/page.tsx` file
  - [x] Export default page component with proper TypeScript types
  - [x] Add JSDoc documentation for the page component

- [x] Task 2: Implement page SEO metadata (AC: 1)
  - [x] Export `metadata` object with title: "Pricing | [Site Name]"
  - [x] Add meta description emphasizing transparent, no-hidden-costs pricing
  - [x] Include OpenGraph tags for social sharing

- [x] Task 3: Define PricingPackage type (AC: 4)
  - [x] Add `PricingPackage` interface to `lib/types.ts` with fields:
    - id: string
    - platform: 'amazon' | 'etsy'
    - tier: 'starter' | 'growth' | 'premium'
    - name: string
    - price: number
    - priceUnit: string (e.g., "/month")
    - description: string
    - features: string[]
    - isPopular?: boolean
    - ctaText: string
    - ctaHref: string
  - [x] Add JSDoc documentation for the interface

- [x] Task 4: Create pricing content data (AC: 2, 3, 9)
  - [x] Create `content/pricing/packages.json` with structure:
    - amazon: array of 3 packages (Starter, Growth, Premium)
    - etsy: array of 3 packages (Starter, Growth, Premium)
  - [x] Use placeholder prices (e.g., Starter: $299, Growth: $499, Premium: $799)
  - [x] Mark "Growth" tier as `isPopular: true` for each platform
  - [x] Include 4-6 features per package

- [x] Task 5: Add content accessor functions (AC: 2, 3)
  - [x] Add `getAmazonPricingPackages()` function to `lib/content.ts`
  - [x] Add `getEtsyPricingPackages()` function to `lib/content.ts`
  - [x] Add `getAllPricingPackages()` function returning both
  - [x] Return typed `PricingPackage[]` arrays
  - [x] Add JSDoc documentation with example usage

- [x] Task 6: Create PricingCard component (AC: 4, 6, 7)
  - [x] Create `components/cards/pricing-card.tsx`
  - [x] Accept `PricingPackage` as prop
  - [x] Display: name, price, description, features list with checkmarks, CTA button
  - [x] Add visual styling for `isPopular` packages (border, badge, slightly larger)
  - [x] Use shadcn/ui Card as base
  - [x] Use Button with `asChild` pattern for Link CTA
  - [x] Add JSDoc documentation and typed props interface

- [x] Task 7: Create PricingSection component (AC: 2, 3, 6, 8)
  - [x] Create `components/sections/pricing-section.tsx`
  - [x] Accept props: headline, packages (PricingPackage[]), platform identifier
  - [x] Render headline as h2
  - [x] Render PricingCard for each package in responsive grid (1‚Üí2‚Üí3 columns)
  - [x] Use Container wrapper for consistent spacing
  - [x] Add JSDoc documentation

- [x] Task 8: Create PricingHero component (AC: 1)
  - [x] Create `components/sections/pricing-hero.tsx`
  - [x] Accept props: headline, subheadline
  - [x] Display transparent pricing message
  - [x] Style consistently with other page heroes (ServiceHero)
  - [x] Add JSDoc documentation

- [x] Task 9: Create BundleHighlight component (AC: 5)
  - [x] Create `components/sections/bundle-highlight.tsx`
  - [x] Display bundle discount prominently with eye-catching styling
  - [x] Include emoji/icon, message, and CTA to contact
  - [x] Use accent (orange) colors for visual emphasis
  - [x] Add JSDoc documentation

- [x] Task 10: Integrate all components on Pricing page (AC: all)
  - [x] Import all created components
  - [x] Import content accessor functions
  - [x] Render PricingHero at top
  - [x] Render Amazon PricingSection with Amazon packages
  - [x] Render Etsy PricingSection with Etsy packages
  - [x] Render BundleHighlight between or after sections
  - [x] Add bottom CTA section linking to /contact

- [x] Task 11: Write component and page tests (AC: all)
  - [x] Create `tests/components/cards/pricing-card.test.tsx`
    - Test: renders package name, price, features
    - Test: renders popular badge when isPopular is true
    - Test: CTA button has correct href
  - [x] Create `tests/components/sections/pricing-section.test.tsx`
    - Test: renders all packages passed as props
    - Test: renders section headline
  - [x] Create `tests/app/pricing.test.tsx`
    - Test: page renders pricing hero with headline
    - Test: page renders Amazon packages section
    - Test: page renders Etsy packages section
    - Test: page renders bundle discount highlight
    - Test: CTA links point to /contact

- [x] Task 12: Final verification (AC: all)
  - [x] Run `npm run lint` - ensure no errors
  - [x] Run `npm run build` - ensure successful build
  - [x] Run `npm run test:run` - ensure all tests pass
  - [x] Verify navigation from homepage "View Pricing" button works
  - [x] Verify visual hierarchy (popular package stands out)

## Dev Notes

### Previous Story Insights (Story 2.10)
[Source: docs/stories/2.10.story.md#dev-agent-record]

- 199 tests passing with Vitest + React Testing Library
- Established patterns for service pages reused here:
  - ServiceHero pattern for page heroes
  - ServiceListSection pattern for section layouts
  - Content accessor pattern in `lib/content.ts`
- Button component with `asChild` pattern for Link wrapping: `<Button asChild><Link href="...">Text</Link></Button>`
- Container component at `components/layout/container.tsx` provides consistent max-width
- Lint and build passing

### Existing Pricing Preview Components
[Source: components/sections/pricing-preview.tsx, components/cards/pricing-preview-card.tsx]

The homepage pricing preview section already exists with:
- `PricingPreview` interface (id, platform, title, startingPrice, features)
- `PricingPreviewCard` component showing preview cards
- Default pricing data: Amazon $499/mo, Etsy $399/mo

The full Pricing Page needs more detailed `PricingPackage` types with:
- Multiple tiers (Starter, Growth, Premium)
- `isPopular` flag for visual hierarchy
- Full feature lists
- CTAs with different destinations

### Component File Locations
[Source: docs/architecture/unified-project-structure.md]

```
app/
‚îú‚îÄ‚îÄ pricing/
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                  # NEW - Create here

components/
‚îú‚îÄ‚îÄ sections/
‚îÇ   ‚îú‚îÄ‚îÄ pricing-hero.tsx          # NEW - Create here
‚îÇ   ‚îú‚îÄ‚îÄ pricing-section.tsx       # NEW - Create here
‚îÇ   ‚îî‚îÄ‚îÄ bundle-highlight.tsx      # NEW - Create here
‚îú‚îÄ‚îÄ cards/
‚îÇ   ‚îú‚îÄ‚îÄ pricing-card.tsx          # NEW - Create here (full pricing card)
‚îÇ   ‚îî‚îÄ‚îÄ pricing-preview-card.tsx  # EXISTS - For homepage preview only

content/
‚îú‚îÄ‚îÄ pricing/
‚îÇ   ‚îî‚îÄ‚îÄ packages.json             # NEW - Create here

lib/
‚îú‚îÄ‚îÄ types.ts                      # MODIFY - Add PricingPackage interface
‚îú‚îÄ‚îÄ content.ts                    # MODIFY - Add pricing accessor functions
‚îî‚îÄ‚îÄ utils.ts                      # EXISTS - cn() utility
```

### PricingPackage Interface (To Be Created)
[Source: docs/architecture/components.md#pricingcard]

```typescript
/**
 * Represents a pricing package for Amazon or Etsy sellers.
 * Used on the pricing page to display package options.
 */
export interface PricingPackage {
  /** Unique identifier for the package */
  id: string;
  /** Target marketplace platform */
  platform: 'amazon' | 'etsy';
  /** Package tier level */
  tier: 'starter' | 'growth' | 'premium';
  /** Display name for the package */
  name: string;
  /** Monthly price in dollars */
  price: number;
  /** Price unit display (e.g., "/month") */
  priceUnit: string;
  /** Brief description of the package */
  description: string;
  /** List of included features */
  features: string[];
  /** Whether this is the recommended package */
  isPopular?: boolean;
  /** CTA button text */
  ctaText: string;
  /** CTA button link destination */
  ctaHref: string;
}
```

### Suggested Pricing Structure
[Source: docs/prd/epic-details.md#story-31, docs/prd/requirements.md#FR4]

**Amazon Packages:**
| Tier | Price | Key Features |
|------|-------|--------------|
| Starter | $299/mo | Account audit, Basic listing optimization, Monthly report |
| Growth (Popular) | $499/mo | Everything in Starter + PPC management, A+ Content, Weekly reports |
| Premium | $799/mo | Everything in Growth + Full account management, Priority support |

**Etsy Packages:**
| Tier | Price | Key Features |
|------|-------|--------------|
| Starter | $199/mo | Shop audit, Basic SEO, Monthly report |
| Growth (Popular) | $399/mo | Everything in Starter + Marketing strategy, Listing optimization, Weekly reports |
| Premium | $599/mo | Everything in Growth + Full shop management, Priority support |

### PricingCard Component Pattern
[Source: docs/architecture/frontend-architecture.md, docs/architecture/components.md]

```typescript
/**
 * Props for the PricingCard component.
 */
interface PricingCardProps {
  /** The pricing package to display */
  package: PricingPackage;
}

/**
 * Displays a pricing package in a card format with features and CTA.
 * Shows a "Popular" badge for recommended packages.
 */
export function PricingCard({ package: pkg }: PricingCardProps) {
  return (
    <Card className={cn("h-full", pkg.isPopular && "border-primary ring-2 ring-primary")}>
      {pkg.isPopular && (
        <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2">
          <span className="bg-primary text-primary-foreground px-3 py-1 text-sm font-medium rounded-full">
            Most Popular
          </span>
        </div>
      )}
      <CardHeader>
        <CardTitle>{pkg.name}</CardTitle>
        <div className="text-3xl font-bold">
          ${pkg.price}<span className="text-sm font-normal">{pkg.priceUnit}</span>
        </div>
        <p className="text-muted-foreground">{pkg.description}</p>
      </CardHeader>
      <CardContent>
        <ul className="space-y-2">
          {pkg.features.map((feature, i) => (
            <li key={i} className="flex items-center gap-2">
              <Check className="h-4 w-4 text-primary" />
              {feature}
            </li>
          ))}
        </ul>
      </CardContent>
      <CardFooter>
        <Button asChild className="w-full" variant={pkg.isPopular ? "default" : "outline"}>
          <Link href={pkg.ctaHref}>{pkg.ctaText}</Link>
        </Button>
      </CardFooter>
    </Card>
  );
}
```

### Responsive Grid Pattern
[Source: components/sections/pricing-preview.tsx]

```typescript
{/* 1 column mobile, 2 columns tablet, 3 columns desktop */}
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
  {packages.map((pkg) => (
    <PricingCard key={pkg.id} package={pkg} />
  ))}
</div>
```

### Bundle Highlight Pattern
[Source: components/sections/pricing-preview.tsx]

The homepage pricing preview has a bundle highlight that can be expanded:

```typescript
<div className="mt-8 text-center">
  <div className="inline-flex items-center gap-2 bg-orange-100 text-orange-800 px-4 py-2 rounded-full text-sm font-medium">
    <span aria-hidden="true">üéÅ</span>
    Bundle & Save: Get both Amazon + Etsy services at a discount
  </div>
</div>
```

For the pricing page, make this more prominent with a full section.

### Page Metadata Pattern
[Source: docs/architecture/frontend-architecture.md, app/services/etsy/page.tsx]

```typescript
import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'Pricing | Agency Name',
  description: 'Transparent pricing for Amazon and Etsy seller consulting. No hidden costs. Choose from Starter, Growth, or Premium packages.',
  openGraph: {
    title: 'Pricing | Agency Name',
    description: 'Transparent pricing for marketplace seller consulting.',
    type: 'website',
  },
};
```

### Existing UI Components to Use
[Source: Current codebase]

1. **Card** (`components/ui/card.tsx`) - CardHeader, CardContent, CardFooter, CardTitle
2. **Button** (`components/ui/button.tsx`) - Use with `asChild` for Link wrapping
3. **Container** (`components/layout/container.tsx`) - Consistent max-width and padding
4. **Check icon** from lucide-react - For feature lists

### Content Accessor Pattern
[Source: lib/content.ts]

```typescript
import packagesData from '@/content/pricing/packages.json';
import type { PricingPackage } from './types';

/**
 * Retrieves all Amazon pricing packages.
 */
export function getAmazonPricingPackages(): PricingPackage[] {
  return packagesData.amazon as PricingPackage[];
}

/**
 * Retrieves all Etsy pricing packages.
 */
export function getEtsyPricingPackages(): PricingPackage[] {
  return packagesData.etsy as PricingPackage[];
}

/**
 * Retrieves all pricing packages for both platforms.
 */
export function getAllPricingPackages(): { amazon: PricingPackage[]; etsy: PricingPackage[] } {
  return {
    amazon: getAmazonPricingPackages(),
    etsy: getEtsyPricingPackages(),
  };
}
```

### Accessibility Requirements
[Source: docs/prd.md, docs/architecture/coding-standards.md]

- WCAG 2.1 AA compliance required
- Proper heading hierarchy (h1 for page hero, h2 for section headlines, h3 for card titles)
- Semantic HTML (main, section, article elements)
- Focus indicators must be visible
- All interactive elements keyboard accessible
- Price information must be accessible to screen readers

### Coding Standards Checklist
[Source: docs/architecture/coding-standards.md]

- [ ] Type Everything: All functions with explicit TypeScript types
- [ ] Component Props: Typed props interface with JSDoc
- [ ] JSDoc Documentation: Component, props, and any helpers
- [ ] Content via Accessors: Use lib/content.ts, not direct JSON imports
- [ ] Image Handling: Use next/image for any images
- [ ] Accessibility: Proper semantic HTML, keyboard accessible
- [ ] No Console Logs: Remove any debugging statements

## Testing

[Source: docs/architecture/testing-strategy.md]

### Test Locations
- `tests/components/cards/pricing-card.test.tsx` - PricingCard unit tests
- `tests/components/sections/pricing-section.test.tsx` - PricingSection unit tests
- `tests/app/pricing.test.tsx` - Page integration tests

### Testing Framework
- Vitest + React Testing Library
- Import from `@testing-library/react`
- Use `describe`, `it`, `expect` from `vitest`

### PricingCard Test Examples

```typescript
import { render, screen } from '@testing-library/react';
import { describe, it, expect } from 'vitest';
import { PricingCard } from '@/components/cards/pricing-card';

const mockPackage = {
  id: 'amazon-growth',
  platform: 'amazon' as const,
  tier: 'growth' as const,
  name: 'Growth',
  price: 499,
  priceUnit: '/month',
  description: 'Perfect for growing sellers',
  features: ['PPC management', 'Weekly reports', 'A+ Content'],
  isPopular: true,
  ctaText: 'Get Started',
  ctaHref: '/contact',
};

describe('PricingCard', () => {
  it('renders package name and price', () => {
    render(<PricingCard package={mockPackage} />);
    expect(screen.getByText('Growth')).toBeInTheDocument();
    expect(screen.getByText(/\$499/)).toBeInTheDocument();
  });

  it('renders all features', () => {
    render(<PricingCard package={mockPackage} />);
    expect(screen.getByText('PPC management')).toBeInTheDocument();
    expect(screen.getByText('Weekly reports')).toBeInTheDocument();
    expect(screen.getByText('A+ Content')).toBeInTheDocument();
  });

  it('shows popular badge when isPopular is true', () => {
    render(<PricingCard package={mockPackage} />);
    expect(screen.getByText(/popular/i)).toBeInTheDocument();
  });

  it('does not show popular badge when isPopular is false', () => {
    render(<PricingCard package={{ ...mockPackage, isPopular: false }} />);
    expect(screen.queryByText(/popular/i)).not.toBeInTheDocument();
  });

  it('renders CTA with correct href', () => {
    render(<PricingCard package={mockPackage} />);
    expect(screen.getByRole('link', { name: /get started/i })).toHaveAttribute('href', '/contact');
  });
});
```

### Page Integration Test Examples

```typescript
import { render, screen } from '@testing-library/react';
import { describe, it, expect } from 'vitest';
import PricingPage from '@/app/pricing/page';

describe('Pricing Page', () => {
  it('renders the pricing hero with headline', () => {
    render(<PricingPage />);
    expect(screen.getByRole('heading', { level: 1 })).toHaveTextContent(/pricing/i);
  });

  it('renders Amazon packages section', () => {
    render(<PricingPage />);
    expect(screen.getByRole('heading', { name: /amazon/i })).toBeInTheDocument();
  });

  it('renders Etsy packages section', () => {
    render(<PricingPage />);
    expect(screen.getByRole('heading', { name: /etsy/i })).toBeInTheDocument();
  });

  it('renders bundle discount highlight', () => {
    render(<PricingPage />);
    expect(screen.getByText(/bundle/i)).toBeInTheDocument();
  });

  it('renders CTA linking to contact', () => {
    render(<PricingPage />);
    expect(screen.getByRole('link', { name: /consultation/i })).toHaveAttribute('href', '/contact');
  });

  it('highlights popular packages', () => {
    render(<PricingPage />);
    const popularBadges = screen.getAllByText(/popular/i);
    expect(popularBadges.length).toBeGreaterThanOrEqual(2); // One for Amazon, one for Etsy
  });
});
```

### Test Coverage Goals
- All acceptance criteria covered by at least one test
- PricingCard renders correctly with all props
- Popular badge displayed conditionally
- Page renders all sections correctly
- CTAs have correct destinations

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-06 | 1.0 | Initial story draft | SM Agent (Bob) |

---

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### File List

**New Files:**
- `app/pricing/page.tsx` - Pricing page with hero, sections, bundle highlight, and bottom CTA
- `components/cards/pricing-card.tsx` - Individual pricing card component with popular badge
- `components/sections/pricing-section.tsx` - Section component for platform pricing grids
- `components/sections/pricing-hero.tsx` - Hero section for pricing page
- `components/sections/bundle-highlight.tsx` - Bundle discount highlight section
- `content/pricing/packages.json` - Pricing data for Amazon and Etsy packages
- `tests/components/cards/pricing-card.test.tsx` - PricingCard unit tests (10 tests)
- `tests/components/sections/pricing-section.test.tsx` - PricingSection unit tests (7 tests)
- `tests/app/pricing.test.tsx` - Pricing page integration tests (13 tests)

**Modified Files:**
- `lib/types.ts` - Added PricingPackage interface
- `lib/content.ts` - Added pricing accessor functions (getAmazonPricingPackages, getEtsyPricingPackages, getAllPricingPackages)

### Debug Log References

None - no blocking issues encountered during development.

### Completion Notes

- All 12 tasks completed successfully
- 229 tests passing (30 new tests added for pricing functionality)
- Lint passes with no warnings or errors
- Build successful with pricing page at /pricing route
- Pricing packages: Amazon ($299/$499/$799), Etsy ($199/$399/$599)
- "Growth" tier marked as popular for both platforms with visual ring styling
- Bundle highlight section uses accent colors with Gift icon
- All CTAs properly link to /contact
- Responsive grid: 1 col mobile, 2 cols tablet, 3 cols desktop
- Homepage "View Pricing" button verified to link correctly

---

## QA Results

### Review Date: 2025-12-06

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Excellent implementation quality. The Pricing Page follows established patterns from previous stories (ServiceHero ‚Üí PricingHero, content accessor pattern) with clean, well-documented code. All components are properly typed with JSDoc documentation and the responsive grid implementation correctly handles mobile/tablet/desktop breakpoints.

### Refactoring Performed

None required - implementation is clean and follows best practices.

### Compliance Check

- Coding Standards: ‚úì All functions typed, JSDoc present, content via accessors
- Project Structure: ‚úì Files in correct locations per unified-project-structure.md
- Testing Strategy: ‚úì 30 new tests covering unit and integration levels
- All ACs Met: ‚úì 9/9 acceptance criteria verified

### Improvements Checklist

All items implemented correctly. No required changes.

- [x] Type-safe PricingPackage interface with full JSDoc
- [x] Content accessor functions (getAmazonPricingPackages, getEtsyPricingPackages, getAllPricingPackages)
- [x] PricingCard with popular badge conditional styling
- [x] PricingSection with responsive grid
- [x] BundleHighlight with accent styling and Gift icon
- [x] Proper heading hierarchy (h1 ‚Üí h2 ‚Üí h3)
- [x] All CTAs link to /contact
- [x] Comprehensive test coverage

### Security Review

No security concerns. All CTAs link to internal `/contact` route. No user input handling, no sensitive data exposure.

### Performance Considerations

Static content with efficient component structure. Pricing data loaded from JSON content files. Build output shows efficient bundle size (96.1 kB first load JS for /pricing).

### Files Modified During Review

None - no refactoring required.

### Gate Status

Gate: PASS ‚Üí docs/qa/gates/3.1-pricing-page.yml

### Recommended Status

‚úì Ready for Done

Story meets all acceptance criteria with comprehensive test coverage and excellent code quality. No blocking issues identified.
