# Story 1.5: Base Layout and Initial Deployment

## Status

Done

## Story

**As a** developer,
**I want** a working base layout deployed to production,
**so that** we have a live URL and can demonstrate progress throughout development.

## Acceptance Criteria

1. Layout component combines Header + main content + Footer
2. Minimal homepage with hero section placeholder ("Coming Soon" or basic content)
3. Site deployed to Vercel/Netlify with automatic deploys from main branch
4. HTTPS working with valid SSL certificate
5. Site loads in under 3 seconds
6. Basic meta tags (title, description) configured
7. Favicon placeholder added

## Tasks / Subtasks

- [x] Task 1: Verify existing layout structure (AC: 1)
  - [x] Confirm `app/layout.tsx` already wraps content with Header + main + Footer
  - [x] Verify flexbox layout for sticky footer (`min-h-screen flex flex-col`, `flex-1` on main)
  - [x] Document current layout structure in completion notes

- [x] Task 2: Create minimal homepage hero placeholder (AC: 2)
  - [x] Replace default Next.js template content in `app/page.tsx`
  - [x] Create simple hero section with:
    - [x] Agency name/headline ("Agency Site" or similar)
    - [x] Brief tagline about e-commerce consulting
    - [x] "Coming Soon" or placeholder call-to-action
  - [x] Use existing Container component for consistent max-width
  - [x] Use existing Button component for CTA placeholder
  - [x] Style with Tailwind using brand colors from design system
  - [x] Ensure responsive layout (centered on mobile, proper spacing)

- [x] Task 3: Configure meta tags for homepage (AC: 6)
  - [x] Update `metadata` export in `app/layout.tsx` with:
    - [x] Site title: "Agency Site | E-commerce Consulting for Amazon & Etsy Sellers"
    - [x] Description: Brief value proposition (under 160 characters)
  - [x] Add `metadataBase` for Open Graph URL resolution
  - [x] Add basic Open Graph tags (og:title, og:description, og:type)

- [x] Task 4: Add favicon placeholder (AC: 7)
  - [x] Create or verify favicon exists at `app/favicon.ico`
  - [x] Optionally add `app/icon.tsx` or static icon files for different sizes
  - [x] Verify favicon displays in browser tab

- [x] Task 5: Prepare for Vercel deployment (AC: 3, 4)
  - [x] Verify `package.json` has correct build script (`next build`)
  - [x] Verify `next.config.mjs` has appropriate settings
  - [x] Create `.env.example` with placeholder environment variables (if not already present)
  - [x] Ensure `.gitignore` excludes `.env.local` and build artifacts
  - [ ] Verify all code is committed to main branch (USER ACTION)
  - [ ] Document deployment steps for manual Vercel setup (USER ACTION):
    - [ ] Connect GitHub repository to Vercel
    - [ ] Configure build settings (Framework: Next.js, auto-detected)
    - [ ] Deploy and verify production URL
    - [ ] Verify automatic deploys trigger on push to main

- [ ] Task 6: Verify HTTPS and SSL (AC: 4)
  - [ ] After Vercel deployment, confirm site loads over HTTPS
  - [ ] Verify valid SSL certificate (no browser warnings)
  - [ ] Test both www and non-www URLs redirect properly (Vercel handles automatically)

- [ ] Task 7: Performance verification (AC: 5)
  - [ ] Run Lighthouse performance audit on deployed site
  - [ ] Verify page load time < 3 seconds
  - [ ] Document Core Web Vitals scores
  - [ ] Optimize if needed (image optimization, bundle size)

- [x] Task 8: Write unit tests for homepage (AC: 2)
  - [x] Create `tests/app/page.test.tsx`
  - [x] Test: Hero section renders with headline
  - [x] Test: Tagline/subheadline renders
  - [x] Test: CTA button renders
  - [x] Test: Page uses Container component or equivalent layout

- [x] Task 9: Final verification and documentation (AC: all)
  - [x] Run `npm run lint` - ensure no errors
  - [x] Run `npm run build` - ensure successful build
  - [x] Run `npm run test:run` - ensure all tests pass
  - [ ] Verify deployed site meets all acceptance criteria (USER ACTION)
  - [ ] Document production URL in completion notes (USER ACTION)

## Dev Notes

### Previous Story Insights (Story 1.4)
[Source: docs/stories/1.4.story.md#dev-agent-record]

- Root layout already updated with Header and Footer integration
- Layout uses `min-h-screen flex flex-col` for sticky footer pattern
- Main content area uses `flex-1` to fill available space
- 59 total tests passing with Vitest + React Testing Library
- Container component available at `components/layout/container.tsx` for consistent max-width
- Button component available with multiple variants
- `cn()` utility in `lib/utils.ts` for className merging
- ResizeObserver polyfill in test setup for Radix UI components

### Current Layout Structure
[Source: app/layout.tsx - already implemented in stories 1.3-1.4]

```typescript
// Root layout already combines Header + main + Footer
<html lang="en">
  <body className="... min-h-screen flex flex-col">
    <Header />
    <main className="flex-1">{children}</main>
    <Footer />
  </body>
</html>
```

AC 1 (Layout component) is already satisfied by the existing implementation. This story focuses on:
- Replacing the homepage placeholder content
- Configuring meta tags
- Deploying to production

### Homepage Hero Placeholder Pattern
[Source: architecture/components.md#hero, architecture/frontend-architecture.md]

The hero placeholder should be simple but demonstrate the layout pattern for the full hero (Epic 2, Story 2.1):

```tsx
import { Container } from '@/components/layout/container';
import { Button } from '@/components/ui/button';

export default function Home() {
  return (
    <section className="py-16 md:py-24">
      <Container>
        <div className="text-center max-w-3xl mx-auto">
          <h1 className="text-4xl md:text-5xl font-bold tracking-tight">
            Agency Site
          </h1>
          <p className="mt-6 text-lg text-muted-foreground">
            Honest e-commerce consulting for Amazon & Etsy sellers.
          </p>
          <div className="mt-10">
            <Button size="lg" disabled>
              Coming Soon
            </Button>
          </div>
        </div>
      </Container>
    </section>
  );
}
```

### Meta Tags Configuration
[Source: architecture/tech-stack.md, PRD requirements]

Next.js App Router uses the `metadata` export for SEO:

```typescript
// app/layout.tsx
import type { Metadata } from 'next';

export const metadata: Metadata = {
  metadataBase: new URL('https://your-domain.vercel.app'), // Update after deployment
  title: {
    default: 'Agency Site | E-commerce Consulting for Amazon & Etsy Sellers',
    template: '%s | Agency Site',
  },
  description: 'Honest, results-driven consulting to help Amazon and Etsy sellers grow their businesses. Transparent pricing, real expertise.',
  openGraph: {
    type: 'website',
    locale: 'en_US',
    siteName: 'Agency Site',
  },
};
```

**Note:** After Vercel deployment, update `metadataBase` with the actual production URL.

### Favicon Configuration
[Source: Next.js documentation, architecture/unified-project-structure.md]

Next.js App Router supports multiple favicon approaches:
1. Static file: `app/favicon.ico` (simplest)
2. Generated icon: `app/icon.tsx` (for dynamic generation)
3. Multiple sizes: `app/icon.png`, `app/apple-icon.png`

For this story, a simple `favicon.ico` placeholder is sufficient. Can be replaced with branded favicon later.

### Vercel Deployment
[Source: architecture/tech-stack.md]

**Deployment configuration:**
- Vercel automatically detects Next.js projects
- Build command: `npm run build` (or `next build`)
- Output: `.next/` directory (auto-detected)
- Node.js version: 18.x or 20.x (specify in `package.json` engines if needed)

**Environment variables (if needed later):**
- `NEXT_PUBLIC_*` for client-side variables
- Server-side variables for API integrations (Epic 3)

**Automatic deployments:**
- Vercel deploys automatically on push to main branch
- Preview deployments for pull requests
- SSL/HTTPS enabled by default on `*.vercel.app` domains

### Performance Requirements
[Source: PRD AC 5, architecture/tech-stack.md]

Target: < 3 second page load

Next.js 14 with App Router provides:
- Automatic code splitting
- Static generation by default
- Image optimization via `next/image`
- Font optimization via `next/font`

Current site should easily meet performance targets since:
- No data fetching (static content)
- Minimal JavaScript (no complex state)
- Tailwind CSS is purged in production

### File Locations
[Source: architecture/unified-project-structure.md]

```
app/
├── layout.tsx              # Root layout - UPDATE metadata
├── page.tsx                # Homepage - REPLACE with hero placeholder
├── favicon.ico             # Favicon - VERIFY or ADD
├── globals.css             # Global styles (already configured)
└── fonts/                  # Font files (already configured)
tests/
└── app/
    └── page.test.tsx       # NEW - Homepage tests
```

### Coding Standards
[Source: architecture/coding-standards.md]

- **Type Everything:** All functions must have explicit TypeScript types
- **Component Props:** All components must have typed props interfaces (if any props)
- **JSDoc Documentation:** All public components MUST have JSDoc comments
- **Accessibility:** All interactive elements must be keyboard accessible
- **No Console Logs:** Remove all `console.log` before merging
- **Image Handling:** Use `next/image` for any images

### Styling Guidelines
[Source: architecture/tech-stack.md, previous stories]

- Use Tailwind utility classes
- Brand primary color: `bg-primary` / `text-primary`
- Use `text-muted-foreground` for secondary text
- Responsive patterns: `py-16 md:py-24` for sections
- Text sizing: `text-4xl md:text-5xl` for hero headlines
- Use Container component for consistent max-width

## Testing

[Source: architecture/testing-strategy.md]

- **Test Location:** `tests/app/`
- **Framework:** Vitest + React Testing Library
- **Test File Naming:** `page.test.tsx`

### Required Tests for This Story

1. `tests/app/page.test.tsx`
   - Hero section renders with headline text
   - Tagline/description renders
   - CTA button renders
   - Page content is centered/properly laid out

### Test Pattern

```typescript
import { render, screen } from '@testing-library/react';
import { describe, it, expect } from 'vitest';
import Home from '@/app/page';

describe('Homepage', () => {
  it('renders the hero headline', () => {
    render(<Home />);
    expect(screen.getByRole('heading', { level: 1 })).toBeInTheDocument();
  });

  it('renders the tagline', () => {
    render(<Home />);
    expect(screen.getByText(/e-commerce consulting/i)).toBeInTheDocument();
  });

  it('renders a CTA button', () => {
    render(<Home />);
    expect(screen.getByRole('button')).toBeInTheDocument();
  });
});
```

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-05 | 1.0 | Initial story draft | SM Agent (Bob) |

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### Debug Log References

None - no blockers encountered

### Completion Notes

**Layout Structure (Task 1):**
- Verified `app/layout.tsx` already implements Header + main + Footer pattern
- Body uses `min-h-screen flex flex-col` for sticky footer
- Main uses `flex-1` to fill available space

**Homepage Hero (Task 2):**
- Replaced default Next.js template with hero placeholder
- Uses Container component for consistent max-width
- Uses Button component (disabled) for "Coming Soon" CTA
- Responsive design with `py-16 md:py-24` and `text-4xl md:text-5xl`

**Meta Tags (Task 3):**
- Added full metadata export with title template pattern
- metadataBase set to placeholder URL (update after deployment)
- OpenGraph tags configured

**Favicon (Task 4):**
- Verified existing favicon.ico (16x16 and 32x32, 32-bit color)

**Deployment Prep (Task 5):**
- Build script verified: `next build`
- `.env.example` exists with placeholder variables
- `.gitignore` properly configured

**Tests (Task 8):**
- Created 6 new tests in `tests/app/page.test.tsx`
- Total tests: 65 passing (up from 59)

**Verification (Task 9):**
- Lint: No errors
- Build: Successful (87.4 kB first load JS for homepage)
- Tests: 65/65 passing

**PENDING USER ACTIONS:**
- Tasks 5 (partial), 6, 7: Require manual Vercel deployment
- Connect GitHub repo to Vercel
- Verify HTTPS/SSL after deployment
- Run Lighthouse audit on deployed site
- Update `metadataBase` URL after deployment

### File List

| File | Status |
|------|--------|
| app/page.tsx | Modified |
| app/layout.tsx | Modified |
| tests/app/page.test.tsx | Created |

## QA Results

### Review Date: 2025-12-05

### Reviewed By: Quinn (Test Architect)

### Risk Assessment

**Review Depth: Standard** - No escalation triggers detected:
- No auth/payment/security files touched
- Tests added to story ✓
- Diff < 500 lines
- First review for this story
- 7 acceptance criteria (moderate, but all straightforward)

### Code Quality Assessment

The implementation is **clean and well-structured**. The code follows established patterns from previous stories and adheres to coding standards.

**Strengths:**
- Homepage component is minimal and focused
- Proper use of Container and Button components from design system
- Layout metadata follows Next.js best practices with title template pattern
- OpenGraph tags properly configured
- JSDoc comment present on Home component
- Explicit return type on component function

**Minor Observations:**
- HTML entity `&amp;` used for ampersand in tagline (correct for JSX)
- `metadataBase` uses placeholder URL that requires update post-deployment

### Requirements Traceability

| AC | Description | Test Coverage | Status |
|----|-------------|---------------|--------|
| 1 | Layout combines Header + main + Footer | Covered by stories 1.3-1.4 tests | ✓ |
| 2 | Minimal homepage with hero placeholder | 6 tests in page.test.tsx | ✓ |
| 3 | Site deployed to Vercel | USER ACTION REQUIRED | ⏳ |
| 4 | HTTPS with valid SSL | USER ACTION REQUIRED | ⏳ |
| 5 | Site loads < 3 seconds | USER ACTION REQUIRED (post-deploy) | ⏳ |
| 6 | Basic meta tags configured | Verified in layout.tsx | ✓ |
| 7 | Favicon placeholder added | Verified app/favicon.ico exists | ✓ |

**Coverage Analysis (Given-When-Then):**

AC 2 Tests:
- **Given** homepage renders, **When** viewed, **Then** hero headline displays "Agency Site"
- **Given** homepage renders, **When** viewed, **Then** tagline about e-commerce consulting appears
- **Given** homepage renders, **When** viewed, **Then** CTA button shows "Coming Soon"
- **Given** homepage renders, **When** button examined, **Then** button is disabled
- **Given** homepage renders, **When** layout examined, **Then** section has responsive padding
- **Given** homepage renders, **When** content examined, **Then** hero content is centered

### Refactoring Performed

None required - code is clean and follows established patterns.

### Compliance Check

- Coding Standards: ✓ Explicit types, JSDoc present, no console logs, Tailwind utilities
- Project Structure: ✓ Files in correct locations per unified-project-structure.md
- Testing Strategy: ✓ Tests in tests/app/, using Vitest + RTL
- All ACs Met: ✓ (for code-complete items) / ⏳ (pending user deployment actions)

### Improvements Checklist

All implementation items are complete. No code changes required.

- [x] Hero section with headline implemented
- [x] Tagline renders correctly
- [x] CTA button with disabled state
- [x] Responsive layout with proper Tailwind classes
- [x] Meta tags configured with title template
- [x] OpenGraph tags configured
- [x] Favicon verified
- [x] 6 unit tests created and passing
- [x] Lint passes (0 errors)
- [x] Build passes (87.4 kB first load JS)

**Pending User Actions (not code issues):**
- [ ] Deploy to Vercel and connect GitHub repo
- [ ] Verify HTTPS/SSL after deployment
- [ ] Run Lighthouse audit on deployed site
- [ ] Update `metadataBase` URL in layout.tsx after deployment
- [ ] Document production URL

### Security Review

**Status: N/A - Low Risk**

This story implements a static marketing page with no:
- User input handling
- Authentication/authorization
- API calls
- Data persistence
- External integrations

No security concerns identified.

### Performance Considerations

**Status: PASS**

- Build output: 87.4 kB first load JS (excellent for Next.js)
- Static generation enabled (no server-side rendering overhead)
- Tailwind CSS purged in production
- Font optimization via next/font
- No images requiring optimization in hero placeholder

Performance target (< 3 seconds) expected to be easily met pending production verification.

### Test Architecture Assessment

**Quality: Good**

- 6 focused unit tests covering AC 2
- Tests use proper RTL patterns (getByRole, getByText)
- Tests verify both content and structure
- Tests are readable and maintainable

**Test Level Appropriateness:**
- Unit tests: Appropriate for component rendering verification
- Integration tests: Not needed (no component interactions)
- E2E tests: Deferred to post-deployment verification

### Files Modified During Review

None - no modifications required.

### Gate Status

Gate: **PASS** → docs/qa/gates/1.5-base-layout-initial-deployment.yml

### Recommended Status

✓ **Ready for Done** (for code-complete items)

**Note:** Tasks 5 (partial), 6, 7 require user actions for Vercel deployment. The code implementation is complete and meets all acceptance criteria that can be verified before deployment. Story owner should move to Done after completing deployment verification.
