# Story 2.8: Homepage FAQ Preview Section

## Status

Done

## Story

**As a** visitor,
**I want** to see answers to common questions on the homepage,
**so that** I can get quick answers without navigating away.

## Acceptance Criteria

1. Section headline (e.g., "Common Questions")
2. 3-5 most common FAQ items with expandable answers
3. Accordion/collapsible component for Q&A
4. Link to full FAQ page for more questions
5. Responsive and accessible (keyboard operable)

## Tasks / Subtasks

- [x] Task 1: Install shadcn/ui Accordion component (AC: 3, 5)
  - [x] Run `npx --yes shadcn@latest add accordion` to add the component
  - [x] Verify accordion component is created at `components/ui/accordion.tsx`
  - [x] Verify Radix UI accordion dependency is added to package.json

- [x] Task 2: Create FAQPreviewSection component (AC: 1, 4)
  - [x] Create new file `components/sections/faq-preview.tsx`
  - [x] Define `FAQItem` interface with question (string) and answer (string)
  - [x] Define `FAQPreviewSectionProps` interface with headline, optional subheadline, optional faqItems array
  - [x] Add JSDoc documentation for component and props
  - [x] Implement section headline with proper typography (`text-3xl md:text-4xl font-bold`)
  - [x] Use Container component for consistent layout
  - [x] Apply section padding `py-16 md:py-24`
  - [x] Use default background (no bg class) for visual alternation from PricingPreviewSection

- [x] Task 3: Implement FAQ Accordion (AC: 2, 3, 5)
  - [x] Import Accordion, AccordionItem, AccordionTrigger, AccordionContent from shadcn/ui
  - [x] Wrap FAQ items in Accordion component with type="single" collapsible
  - [x] Each FAQ item renders as AccordionItem with unique value
  - [x] AccordionTrigger displays the question
  - [x] AccordionContent displays the answer
  - [x] Style accordion with proper spacing and typography
  - [x] Constrain max-width for readability (`max-w-3xl mx-auto`)

- [x] Task 4: Define default FAQ content (AC: 2)
  - [x] Create 3-5 most common FAQ items as default data
  - [x] FAQ topics: pricing transparency, platforms supported, consultation process, timeline expectations, guarantees/approach
  - [x] Store as typed array within component or as default props

- [x] Task 5: Add CTA link to full FAQ page (AC: 4)
  - [x] Add Link component pointing to `/faq`
  - [x] Use Button component with secondary or outline variant
  - [x] Text: "View All FAQs" or "See More Questions"
  - [x] Center-align below accordion

- [x] Task 6: Ensure accessibility (AC: 5)
  - [x] Verify accordion is keyboard navigable (Enter/Space to toggle)
  - [x] Verify proper ARIA attributes from Radix Accordion
  - [x] Use semantic HTML (section element, h2 for headline)
  - [x] Ensure focus indicators are visible

- [x] Task 7: Integrate FAQPreviewSection into homepage (AC: all)
  - [x] Import FAQPreviewSection component in `app/page.tsx`
  - [x] Add section after PricingPreviewSection component
  - [x] Pass appropriate props for headline
  - [x] Update page JSDoc to include FAQ preview section

- [x] Task 8: Write unit tests for FAQPreviewSection (AC: all)
  - [x] Create `tests/components/sections/faq-preview.test.tsx`
  - [x] Test: FAQPreviewSection renders section headline
  - [x] Test: FAQPreviewSection renders all FAQ items
  - [x] Test: FAQ questions are visible by default
  - [x] Test: CTA link to FAQ page is present with correct href
  - [x] Test: Accordion items can be expanded (click simulation)
  - [x] Test: Accordion content is hidden when collapsed

- [x] Task 9: Final verification (AC: all)
  - [x] Run `npm run lint` - ensure no errors
  - [x] Run `npm run build` - ensure successful build
  - [x] Run `npm run test:run` - ensure all tests pass
  - [x] Manually verify accordion keyboard navigation
  - [x] Manually verify responsive behavior at mobile, tablet, desktop
  - [x] Verify visual distinction from adjacent sections

## Dev Notes

### Previous Story Insights (Story 2.7)
[Source: docs/stories/2.7.story.md#dev-agent-record]

- PricingPreviewSection uses `bg-muted/30` background
- Section follows pattern: Container wrapper, centered header with h2, content grid, CTA button
- Responsive grid: `grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8`
- Container component at `components/layout/container.tsx` provides consistent max-width
- 153 tests passing with Vitest + React Testing Library
- For FAQPreviewSection, use **default background (no bg class)** to alternate from PricingPreview

### Component File Locations
[Source: docs/architecture/unified-project-structure.md]

```
components/
├── ui/                        # shadcn/ui primitives
│   ├── accordion.tsx          # NEW - Install via shadcn CLI
│   ├── button.tsx             # EXISTS
│   └── ...
├── sections/                  # Page section components
│   ├── hero.tsx               # EXISTS
│   ├── services-overview.tsx  # EXISTS
│   ├── how-it-works.tsx       # EXISTS
│   ├── why-choose-us.tsx      # EXISTS
│   ├── results-gallery.tsx    # EXISTS
│   ├── testimonials.tsx       # EXISTS
│   ├── pricing-preview.tsx    # EXISTS
│   └── faq-preview.tsx        # NEW - Create here
├── layout/
│   └── container.tsx          # EXISTS - Use for section wrapper
```

### Accordion Component (shadcn/ui)
[Source: docs/architecture/components.md, docs/architecture/frontend-architecture.md]

**Architecture Definition:**
```
Accordion
- Responsibility: Expandable FAQ items
- Key Interfaces: AccordionItem, AccordionTrigger, AccordionContent
- Dependencies: shadcn/ui Accordion (Radix)
- Technology Stack: React, Tailwind, Radix Accordion
```

**Installation Command:**
```bash
npx --yes shadcn@latest add accordion
```

**Usage Pattern (from shadcn/ui docs):**
```typescript
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion"

<Accordion type="single" collapsible>
  <AccordionItem value="item-1">
    <AccordionTrigger>Question text here?</AccordionTrigger>
    <AccordionContent>
      Answer text here.
    </AccordionContent>
  </AccordionItem>
</Accordion>
```

### FAQPreviewSection Component Specification
[Source: docs/architecture/frontend-architecture.md, extrapolated from existing section patterns]

**Suggested Props Interface:**
```typescript
/**
 * Represents a single FAQ item.
 */
export interface FAQItem {
  /** Unique identifier for the FAQ item */
  id: string;
  /** The question text */
  question: string;
  /** The answer text */
  answer: string;
}

/**
 * Props for the FAQPreviewSection component.
 */
export interface FAQPreviewSectionProps {
  /** Section headline text */
  headline: string;
  /** Optional subheadline text */
  subheadline?: string;
  /** Array of FAQ items to display (defaults to common questions) */
  faqItems?: FAQItem[];
}
```

### Default FAQ Content
[Source: docs/prd.md, extrapolated from service offerings]

```typescript
const defaultFAQItems: FAQItem[] = [
  {
    id: 'faq-1',
    question: 'What platforms do you support?',
    answer: 'We specialize in Amazon and Etsy marketplace consulting. Whether you\'re selling on one platform or both, we can help optimize your presence and grow your sales.',
  },
  {
    id: 'faq-2',
    question: 'How does the consultation process work?',
    answer: 'We start with a free discovery call to understand your business and goals. From there, we create a custom strategy tailored to your specific needs and provide ongoing support throughout implementation.',
  },
  {
    id: 'faq-3',
    question: 'Are there any hidden fees?',
    answer: 'No hidden fees, ever. We believe in transparent pricing. What you see on our pricing page is what you pay. We\'ll always discuss any costs upfront before starting work.',
  },
  {
    id: 'faq-4',
    question: 'How long before I see results?',
    answer: 'Results vary depending on your starting point and goals, but most clients see measurable improvements within 30-60 days. We focus on sustainable growth, not quick fixes.',
  },
  {
    id: 'faq-5',
    question: 'Do you offer refunds or guarantees?',
    answer: 'We stand behind our work. While marketplace success depends on many factors, we offer a satisfaction guarantee on our consulting services. If you\'re not happy with our recommendations, we\'ll work with you to make it right.',
  },
];
```

### Existing UI Components to Use
[Source: docs/architecture/frontend-architecture.md, current codebase]

1. **Container** (`components/layout/container.tsx`)
   - Use for consistent max-width and padding
   - Default size is "xl"

2. **Button** (`components/ui/button.tsx`) - EXISTS
   - Use outline or secondary variant for CTA
   - Wrap with Link component for routing

3. **cn()** utility (`lib/utils.ts`)
   - For className merging with Tailwind

### Visual Distinction Approach
[Source: Extrapolated from existing section patterns]

Current section backgrounds (in order on homepage):
- Hero: Default (no explicit bg)
- ServicesOverview: Default
- HowItWorks: `bg-muted/30`
- WhyChooseUs: `bg-primary/5`
- ResultsGallery: `bg-muted/30`
- TestimonialsSection: Default (no bg)
- PricingPreviewSection: `bg-muted/30`
- **FAQPreviewSection**: **Use default (no bg)** to create alternating rhythm

### CTA Button Pattern
[Source: Existing components in codebase]

```typescript
import Link from 'next/link';
import { Button } from '@/components/ui/button';

// In the section component:
<Button asChild variant="outline" size="lg">
  <Link href="/faq">View All FAQs</Link>
</Button>
```

### Accessibility Requirements
[Source: docs/prd.md, docs/architecture/coding-standards.md]

- WCAG 2.1 AA compliance required
- Proper heading hierarchy (h2 for section headline)
- Accordion must be keyboard operable:
  - Enter/Space to expand/collapse items
  - Arrow keys to navigate between items (handled by Radix)
- Focus indicators must be visible
- ARIA attributes automatically handled by Radix Accordion
- Semantic HTML (section, h2, button for triggers)

### Coding Standards Checklist
[Source: docs/architecture/coding-standards.md]

- [ ] Type Everything: All functions with explicit TypeScript types
- [ ] Component Props: Typed props interface with JSDoc
- [ ] JSDoc Documentation: Component, props, and any helpers
- [ ] Accessibility: Proper semantic HTML, ARIA where needed
- [ ] No Console Logs: Remove any debugging statements

## Testing

[Source: docs/architecture/testing-strategy.md]

### Test Location
- `tests/components/sections/faq-preview.test.tsx`

### Testing Framework
- Vitest + React Testing Library
- Import from `@testing-library/react`
- Use `describe`, `it`, `expect` from `vitest`

### Required Tests for FAQPreviewSection

```typescript
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { describe, it, expect } from 'vitest';
import { FAQPreviewSection } from '@/components/sections/faq-preview';

describe('FAQPreviewSection', () => {
  it('renders the section headline', () => {
    render(<FAQPreviewSection headline="Common Questions" />);
    expect(screen.getByRole('heading', { level: 2 })).toHaveTextContent('Common Questions');
  });

  it('renders optional subheadline when provided', () => {
    render(
      <FAQPreviewSection
        headline="Common Questions"
        subheadline="Quick answers to help you decide"
      />
    );
    expect(screen.getByText(/Quick answers/i)).toBeInTheDocument();
  });

  it('renders all FAQ questions', () => {
    render(<FAQPreviewSection headline="Common Questions" />);
    // Default FAQ items should be rendered
    expect(screen.getByText(/What platforms do you support/i)).toBeInTheDocument();
    expect(screen.getByText(/How does the consultation process work/i)).toBeInTheDocument();
  });

  it('renders FAQ answers in collapsed state initially', () => {
    render(<FAQPreviewSection headline="Common Questions" />);
    // Answers should exist but be hidden/collapsed initially
    // The answer text exists in DOM but is visually hidden by Radix
    const answerContent = screen.getByText(/We specialize in Amazon and Etsy/i);
    expect(answerContent).toBeInTheDocument();
  });

  it('expands accordion item when trigger is clicked', async () => {
    const user = userEvent.setup();
    render(<FAQPreviewSection headline="Common Questions" />);

    const trigger = screen.getByRole('button', { name: /What platforms do you support/i });
    await user.click(trigger);

    // After click, the accordion item should be expanded
    expect(trigger).toHaveAttribute('data-state', 'open');
  });

  it('renders the CTA link to FAQ page', () => {
    render(<FAQPreviewSection headline="Common Questions" />);
    const link = screen.getByRole('link', { name: /View All FAQs/i });
    expect(link).toHaveAttribute('href', '/faq');
  });

  it('renders custom FAQ items when provided', () => {
    const customFAQs = [
      { id: 'custom-1', question: 'Custom Question?', answer: 'Custom Answer' },
    ];
    render(<FAQPreviewSection headline="FAQs" faqItems={customFAQs} />);
    expect(screen.getByText('Custom Question?')).toBeInTheDocument();
  });
});
```

### Test Coverage Goals
- All acceptance criteria covered by at least one test
- Component renders correctly with default props
- Component renders correctly with custom props
- Accordion functionality works (expand/collapse)
- CTA link points to correct page
- Responsive layout verified via visual testing (manual)
- Keyboard accessibility verified (manual)

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### File List
| File | Action |
|------|--------|
| components/ui/accordion.tsx | Created (via shadcn CLI) |
| components/sections/faq-preview.tsx | Created |
| app/page.tsx | Modified (added FAQPreviewSection import and usage) |
| tests/components/sections/faq-preview.test.tsx | Created |
| package.json | Modified (added @radix-ui/react-accordion dependency) |

### Debug Log References
None - implementation completed without issues.

### Completion Notes
- Installed shadcn/ui Accordion component with Radix UI dependency
- Created FAQPreviewSection with 5 default FAQ items covering: platforms, consultation process, hidden fees, timeline, guarantees
- Accordion uses `type="single" collapsible` for single-item expansion
- Component uses default background (no bg class) to alternate from PricingPreviewSection's `bg-muted/30`
- All 163 tests pass (10 new tests for FAQPreviewSection)
- Lint and build pass successfully
- Accessibility verified: Radix Accordion provides keyboard navigation (Enter/Space/Arrow keys) and proper ARIA attributes

### Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-12-05 | 1.0 | Initial story draft | SM Agent (Bob) |
| 2025-12-05 | 1.1 | Implementation complete | Dev Agent (James) |

---

## QA Results

### Review Date: 2025-12-05

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Implementation is clean, well-structured, and follows established patterns in the codebase. The FAQPreviewSection component demonstrates excellent code organization with:

- Properly typed interfaces with JSDoc documentation
- Reusable default FAQ content with clear customization capability
- Semantic HTML structure (section, h2)
- Proper use of Container component for layout consistency
- Correct visual alternation (default background after PricingPreview's `bg-muted/30`)

### Refactoring Performed

No refactoring required. The implementation is clean and follows best practices.

### Compliance Check

- Coding Standards: ✓ All functions typed, JSDoc present, no console logs, proper component structure
- Project Structure: ✓ Files in correct locations per unified-project-structure.md
- Testing Strategy: ✓ Unit tests cover component behavior, follows Vitest + RTL patterns
- All ACs Met: ✓ All 5 acceptance criteria fully implemented and verified

### Improvements Checklist

No improvements required. All items are complete:

- [x] Component follows established section patterns
- [x] Proper TypeScript typing with interfaces
- [x] JSDoc documentation complete with examples
- [x] All 5 FAQ items implemented with appropriate content
- [x] Accordion uses type="single" collapsible as specified
- [x] CTA link properly styled with Button asChild pattern
- [x] Accessibility via Radix UI Accordion (keyboard nav, ARIA)
- [x] 10 comprehensive tests covering all ACs
- [x] Lint, build, and all 163 tests passing

### Security Review

No security concerns. This is a presentational component with:
- No user input handling
- No external data fetching
- No authentication/authorization touchpoints
- Static content only (default FAQ items or props)

### Performance Considerations

No performance concerns. The component:
- Uses static content (no data fetching)
- Accordion uses Radix UI's optimized animations
- No heavy computations or unnecessary re-renders
- Lazy rendering of accordion content via Radix

### Files Modified During Review

None. Implementation meets all quality standards.

### Gate Status

Gate: **PASS** → docs/qa/gates/2.8-homepage-faq-preview-section.yml

### Recommended Status

✓ Ready for Done - All acceptance criteria met, tests passing, no issues identified.
